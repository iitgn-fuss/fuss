{{/* Latest News Shortcode - Automatically displays the latest 3 news items */}}
{{ $newsPages := where .Site.RegularPages "Section" "news" }}
{{ $latestNews := first 3 ($newsPages.ByDate.Reverse) }}

{{/* Define gradient colors for news cards */}}
{{ $gradients := slice 
  "background: radial-gradient(ellipse at 50% 80%,rgba(59,130,246,0.15),hsla(0,0%,100%,0));" 
  "background: radial-gradient(ellipse at 50% 80%,rgba(16,185,129,0.15),hsla(0,0%,100%,0));" 
  "background: radial-gradient(ellipse at 50% 80%,rgba(251,146,60,0.15),hsla(0,0%,100%,0));" 
}}

<!-- {{/* Define images for variety */}}
{{ $images := slice "images/hextra-doc.webp" "images/hextra-markdown.webp" "images/hextra-search.webp" }} -->

{{ if $latestNews }}
<div class="hx:grid hx:gap-4 hx:mt-4 hx:md:grid-cols-2 hx:lg:grid-cols-3">
  {{ range $index, $page := $latestNews }}
    {{ $gradient := index $gradients (mod $index 3) }}
    
    <div class="hx:group hx:overflow-hidden hx:rounded-lg hx:border hx:border-gray-200 hx:text-current hx:no-underline hx:dark:shadow-none hx:dark:border-neutral-800 hx:bg-transparent hx:shadow-gray-100 hx:aspect-auto hx:min-h-[200px] news-card" style="{{ $gradient | safeCSS }}">
      <a href="{{ $page.RelPermalink }}" class="hx:block hx:h-full">
        <div class="hx:p-6 hx:flex hx:flex-col hx:justify-between hx:flex-1 hx:h-full">
          <div>
            <h3 class="hx:font-semibold hx:tracking-tight hx:text-slate-900 hx:dark:text-slate-100 hx:text-lg hx:mb-2">
              {{ $page.Title }}
            </h3>
            <p class="hx:text-slate-700 hx:dark:text-slate-400 hx:text-sm hx:leading-relaxed">
              {{ $page.Summary | default (truncate 120 ($page.Content | plainify)) }}
            </p>
          </div>
          <div class="hx:mt-4 hx:text-xs hx:text-slate-500">
            {{ $page.Date.Format "January 2, 2006" }}
          </div>
        </div>
      </a>
    </div>
  {{ end }}
</div>

<div class="hx:mt-8 hx:text-center">
  <a href="{{ .Site.BaseURL }}news"
    class="hx:inline-flex hx:items-center hx:justify-center hx:rounded-md hx:bg-blue-600 hx:hover:bg-blue-700 hx:px-6 hx:py-3 hx:text-sm hx:font-medium hx:text-white hx:transition-colors">
    View All News
    <svg class="hx:ml-2 hx:h-4 hx:w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
    </svg>
  </a>
</div>
{{ else }}
{{/* Fallback if no news items exist */}}
<div class="hx:text-center hx:text-gray-600 hx:py-8">
  <p>No news items available yet.</p>
</div>
{{ end }}
